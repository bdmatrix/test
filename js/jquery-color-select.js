"use strict";var _createClass=function(){function r(o,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(o,r.key,r)}}return function(o,t,e){return t&&r(o.prototype,t),e&&r(o,e),o}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o};function _classCallCheck(o,t){if(!(o instanceof t))throw new TypeError("Cannot call a class as a function")}!function(o){"function"==typeof define&&define.amd?define(["jquery"],o):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=o:o(jQuery)}(function(p){var u=function(){var o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"div",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=null!==o.match(/^[\w-]+/g)?o.match(/^[\w-]+/g)[0]:"div",r=null!==o.match(/#[\w\d-_]+/g)?o.match(/#[\w\d-_]+/g)[0].replace("#",""):"",n=null!==o.match(/\.[\w\d-_]+/g)?o.match(/\.[\w\d-_]+/g).map(function(o){return o.replace(".","")}).join(" "):"",c=p(document.createElement(e));for(var i in 0<r.length&&c.attr("id",r),0<n.length&&c.attr("class",n),t)c.attr(i,t[i]);return c},f=function(o){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(o){};t&&(o.preventDefault(),o.stopPropagation(),o.stopImmediatePropagation(),e(o))},l=function(){var o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=o.match(/#[0-9a-fA-F]{6}\b/g),e=o.match(/#[0-9a-fA-F]{3}\b/g),r=o.match(/(rgb|RGB)\s*\(\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*\d{1,3}\s*\)/g),n=o.match(/(rgba|RGBA)\s*\(\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*\d*?\.?\d*?\s*\)/g),c=o.match(/(hsl|HSL)\s*\(\s*\d+\s*,\s*\d{1,3}%\s*,\s*\d{1,3}%\s*\)/g),i=o.match(/(hsla|HSLA)\s*\(\s*\d+\s*,\s*\d{1,3}%\s*,\s*\d{1,3}%\s*,\s*\d*?\.?\d*?\s*\)/g),a=(void 0===o?"undefined":_typeof(o))===_typeof({})&&"number"==typeof o.h&&"number"==typeof o.s&&"number"==typeof o.l,l={};if(null!==t){var s=t[0].replace("#","").split("");l.r=parseInt(s[0]+s[1],16),l.g=parseInt(s[2]+s[3],16),l.b=parseInt(s[4]+s[5],16)}else if(null!==e){var p=e[0].replace("#","").split("");l.r=parseInt(p[0]+p[0],16),l.g=parseInt(p[1]+p[1],16),l.b=parseInt(p[2]+p[2],16)}else if(null!==r||null!==n){var u=r[0].replace(/(rgb|RGB|rgba|RGBA)\s*\(\s*/g,"").replace(/\s*\)/g,"").split(",");l.r=parseInt(u[0].trim()),l.g=parseInt(u[1].trim()),l.b=parseInt(u[2].trim())}else if(null!==c||null!==i||a){var f=void 0,d=void 0,g=void 0;if(a)f=o.h,d=o.s,g=o.l;else{var h=c[0].replace(/(hsl|HSL|hsla|HSLA)\s*\(\s*/g,"").replace(/\s*\)/g,"").split(",");f=parseInt(h[0].trim())%360/359,d=parseInt(h[1].trim())/100,g=parseInt(h[2].trim())/100}var v=void 0,m=void 0,b=void 0;if(0===d)v=m=b=g;else{var k=function(o,t,e){return e<0&&(e+=1),1<e&&(e-=1),e<1/6?o+6*(t-o)*e:e<.5?t:e<2/3?o+6*(t-o)*(2/3-e):o},y=g<.5?g*(1+d):g+d-g*d,C=2*g-y;v=k(C,y,f+1/3),m=k(C,y,f),b=k(C,y,f-1/3)}l={r:Math.max(Math.min(256*v,255),0),g:Math.max(Math.min(256*m,255),0),b:Math.max(Math.min(256*b,255),0)}}else l=null;return l},a=function(){var o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if((void 0===o?"undefined":_typeof(o))!==_typeof({})||"number"!=typeof o.r||"number"!=typeof o.g||"number"!=typeof o.b)return o.toString(16);var e=o.r.toString(16),r=o.g.toString(16),n=o.b.toString(16);return(t?"":"#")+(o.r<16?"0"+e:e)+(o.g<16?"0"+r:r)+(o.b<16?"0"+n:n)},d=function(o){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return Math.round(Math.pow(10,parseInt(t))*parseFloat(o))/Math.pow(10,parseInt(t))},r=p([]),s=!1,g={colorPicker:{root:r,picker:r,submit:r,current:r,wrapper:r,new:r},colorContext:{source:r,target:r,select:function(){}},initColorPicker:function(){var t=this;if(!s){g.colorContext;var n=u(".picker-root").ColorPicker({color:l("#fff"),onShow:function(o){return!1},onHide:function(o){return!1},onChange:function(o,t,e){g.colorContext.source.css("backgroundColor","#"+t),g.colorContext.select(g.colorContext.target,"#"+t,"test")},onSubmit:function(o,t,e){g.colorContext.source.css("backgroundColor","#"+t),g.colorContext.select(g.colorContext.target,"#"+t,"test"),g.hideColorPicker(!0),v.add("#"+t)},flat:!0}).mousedown(function(o){return o.stopPropagation()});n.find("input").attr("tabindex","-1");var c=n.find(".colorpicker .colorpicker_current_color").click(function(o){var t=l(c.attr("style"));n.ColorPickerSetColor(t),g.colorContext.source.css("background-color","rgb("+t.r+", "+t.g+", "+t.b+")"),g.colorContext.select(g.colorContext.target,a(t),"reset")}).attr("title","Restore previous color").ripple();n.find(".colorpicker .colorpicker_color").mousedown(function(o){var t=new MouseEvent("mousemove",o);document.dispatchEvent(t)}),n.find(".colorpicker .colorpicker_hue").mousedown(function(o){var t=new MouseEvent("mousemove",o);document.dispatchEvent(t)});var i=n.find(".colorpicker .colorpicker_new_color"),o=n.find(".colorpicker .colorpicker_submit").attr("title","Apply current color").click(function(o){console.log("COLOR SUBMIT >> ",o),o.isTrigger||t.colorContext.source.trigger("change")}),e=n.find(".colorpicker").append(v.clone()).on("color-pick",function(o,t){var e=l(c.attr("style")),r=l(t.color);n.ColorPickerSetColor(r),c.css("background-color","rgb("+e.r+", "+e.g+", "+e.b+")"),i.css("background-color","rgb("+r.r+", "+r.g+", "+r.b+")"),g.colorContext.source.css("background-color","rgb("+r.r+", "+r.g+", "+r.b+")"),g.colorContext.select(g.colorContext.target,a(r),"test")}),r=u(".picker-wrapper").append(n).mousedown(function(o){g.hideColorPicker()});g.colorPicker={root:n,picker:e,submit:o,current:c,wrapper:r,new:i},p(document.body).append(r),s=!0}},showColorPicker:function(){var o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:u(),t=arguments[1],e=arguments[2];console.log("PickerTrigger!");var r=l(p(o).css("background-color")),n=o.offset(),c=n.top,i=n.left+o[0].offsetWidth/2-153,a=c+o[0].offsetHeight;g.colorContext={source:o,target:t,select:e},g.colorPicker.root.css({top:a,left:i}).ColorPickerSetColor(r),g.colorPicker.submit.click(),g.colorPicker.wrapper.addClass("visible")},hideColorPicker:function(){0<arguments.length&&void 0!==arguments[0]&&arguments[0]||g.colorPicker.current.click(),g.colorPicker.wrapper.removeClass("visible")},applyGradient:function(){var o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:r,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};o.css("background",g.cssGradient(t,e))},cssGradient:function(){var o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=o.map(function(o){var t=l(o.color);return"rgba("+t.r+","+t.g+","+t.b+","+o.opacity+") "+o.offset+"%"}),r=t.x1,n=t.y1,c=t.x2,i=t.y2;return"linear-gradient("+(180*Math.atan2(parseFloat(i)-parseFloat(n),parseFloat(c)-parseFloat(r))/Math.PI+90)%360+"deg, "+e.join(", ")+")"},svgGradientStops:function(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).map(function(o){var t=l(o.color);return'<stop offset="'+o.offset+'%" stop-color="rgb('+t.r+","+t.g+","+t.b+')" stop-opacity="'+o.opacity+'" />'}).join("")}};p(window).on("load",function(o){g.initColorPicker()});var o=u(".color-pallete-root"),i={},h=[],v=function(){function n(){_classCallCheck(this,n)}return _createClass(n,null,[{key:"add",value:function(e){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";if(!((e=a(l(e)))in i)){var t=l(e),r=u(".pallete-color",{style:"background: "+e+";",colorcode:e,colorname:o,title:"rgb("+t.r+", "+t.g+", "+t.b+") / "+e});return n.root.append(r),h.forEach(function(o){var t=r.clone().click(function(o){t.trigger("color-pick",{color:e})}).ripple({type:"icon-big"});o.append(t)}),i[e]=o,n}}},{key:"remove",value:function(t){if((t=a(l(t)))in i)return n.root.find('[colorcode="'+t+'"]').remove(),h.forEach(function(o){return o.find('[colorcode="'+t+'"]').remove()}),delete i[t],n}},{key:"list",value:function(){var e=[];return n.root.children(c).each(function(o,t){e.push(p(t).attr("colorcode"))}),e}},{key:"clone",value:function(){var o=n.root.clone();o.find(".pallete-color").each(function(o,t){var e=p(t),r=p(t).attr("colorcode");e.click(function(o){e.trigger("color-pick",{color:r})}).ripple({type:"icon-big"})});return h.push(o),o}},{key:"root",get:function(){return o}}]),n}();return window.ColorPallete=v,p.fn.colorSelect=function(){var o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"click",t=arguments[1],e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(o){return o};return p(this).on(o,function(o){f(o),s?g.showColorPicker(p(o.target),t,e):g.initColorPicker()}),this},p.fn.gradientSelect=function(){0<arguments.length&&void 0!==arguments[0]&&arguments[0];var c=arguments[1],i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(o){return o},o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},a=o.stops,l=o.attr,e=p(p(this)[0]).empty().addClass("gradient-select closed").click(function(o){e.toggleClass("closed")}),s=(u(".gradient-preview").appendTo(e),u(".gradient-slider").appendTo(e).contextmenu(function(o){f(o);var t={offset:99,color:"#000",opacity:.5};a.push(t),r(t,a.length-1),i(c,{stops:a,attr:l},g.svgGradientStops(a)),e.trigger("startchange",a)})),r=function(r,o){var n=u(".color-stop").css({position:"absolute",top:100-100*r.opacity+"%",left:r.offset+"%",background:r.color}).appendTo(s).draggable({start:function(o,t){e.trigger("startchange",a)},stop:function(o,t){e.trigger("stopchange",a),n.css({top:d(100*parseFloat(n.css("top"))/s.height(),3)+"%",left:d(100*parseFloat(n.css("left"))/s.width(),3)+"%"})},drag:function(o,t){var e=n.position();r.offset=e.left/s.width()*100,r.opacity=Math.round(100-Math.max(10,Math.min(110,120*e.top/s.height()))+10)/100,i(c,{stops:a,attr:l},g.svgGradientStops(a)),g.applyGradient(s,a,l)},containment:"parent"}).colorSelect("click",r,function(o,t){o.color=t,i(c,{stops:a,attr:l},g.svgGradientStops(a)),g.applyGradient(s,a,l),e.trigger("change",a)}).contextmenu(function(o){f(o),a.length<3||(r.remove=!0,a.forEach(function(o,t){!0===o.remove&&a.splice(t,1)}),n.remove(),i(c,{stops:a,attr:l},g.svgGradientStops(a)),g.applyGradient(s,a,l),e.trigger("startchange",a))});g.applyGradient(s,a,l)},t=function(o,t,r){var n=u(".color-point").css({top:t,left:o}).appendTo(s).draggable({start:function(o,t){e.trigger("startchange",a)},stop:function(o,t){e.trigger("stopchange",a),n.css({top:d(100*parseFloat(n.css("top"))/s.height(),3)+"%",left:d(100*parseFloat(n.css("left"))/s.width(),3)+"%"})},drag:function(o,t){var e=n.position();l["x"+r]=d(100*e.left/s.width(),3)+"%",l["y"+r]=d(100*e.top/s.height(),3)+"%",i(c,{stops:a,attr:l},g.svgGradientStops(a)),g.applyGradient(s,a,l)},containment:"parent"});return n};return a.forEach(function(o,t){r(o,t)}),t(l.x1,l.y1,1),t(l.x2,l.y2,2),this},p});